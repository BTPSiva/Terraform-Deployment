dockerImage: "hashicorp/terraform:1.6.6"

stages:
  - name: Init
  - name: Plan
  - name: Apply

steps:
  Init:
    runSh:
      shell: bash
      script: |
        echo "ğŸš€ Init Stage Started"
        pwd
        ls -la
        terraform version || { echo "âŒ Terraform not found"; exit 1; }
        terraform init

  Plan:
    runSh:
      shell: bash
      script: |
        echo "ğŸ“¦ Planning Infrastructure"
        terraform plan -out=tfplan

  Apply:
    runSh:
      shell: bash
      script: |
        echo "ğŸš€ Applying Infrastructure"
        terraform apply -auto-approve tfplan
